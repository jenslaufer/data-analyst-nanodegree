---
title: "Influence of a society open to part time work on female employment ratio"
output: html_notebook
---

# Introduction

In Germany, it's hard for woman to find a part time job. The companies and the society aren't open to people working part time.
Within this little data analysis I want to analyze if I can prove an influence on female employment rate, if a society is open to part time work.
I am using a dataset from [Female Employment rate over 15 from Gapminder](https://docs.google.com/spreadsheets/d/1jsXSKnWgsXvjYyR-4R2b9VKGh22IM70C9WQg74xK8U8/pub?gid=0)



```{r Data Set Import}
raw <- read.csv('indicator_f above 15 employ.csv')

str(raw)

```
```{r Example data}

head(raw)

```



## Problems in the data

  - The CSV file I am using is using the german format for float numbers which is e.g 18,05 instead of 18.05. The numbers are saved as Strings because of this.
  - The years start with a X.
  
These problems needs to be fixed.


```{r Fixing problem in the data}
library(tidyr)
# fixed format:
#Each variable is saved in its own column.
# Each observation is saved in its
df <- tidyr::gather(raw, "year", "employment_rate", 2:18)
# fix strange X in front of gthe year and make a nurmeric
df$year <- as.factor(
sapply(df$year, function(df) {
as.numeric(gsub("X", "", df))
}))

# fix lgerman localized numeric values
df$employment_rate <-
sapply(df$employment_rate, function(df) {
as.numeric(gsub(",", ".", df))
})
colnames(df) <- c("country", "year", "employment_rate")

str(df)

library(ggplot2)
p1 <-
ggplot(data = df,
mapping = aes(x = year, y = employment_rate))
p1 + geom_boxplot() 

```
```{r}
p2 <-
ggplot(data = subset(df, country %in% c('Germany', 'France', 'Italy', 'Norway', 'Sweden', 'Denmark', 'Spain', 'Australia', 'United States')),
mapping = aes(x = country, y = employment_rate))
p2 + geom_boxplot() 
```

```{r}

```p3 <- ggplot(data=subset(df, country %in% c('Germany', 'Norway', 'Sweden')), mapping= aes(x=year, y=employment_rate, group=1))
p3 <- p3 + geom_line() 
p3 <- p3 + facet_wrap(~country, ncol = 1, scales='fixed')
p3 


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).
